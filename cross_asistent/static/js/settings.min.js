function getCSRFToken(){for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var o=jQuery.trim(t[e]);if("csrftoken="==o.substring(0,10))return decodeURIComponent(o.substring(10))}const a=$("[name=csrfmiddlewaretoken]").val();return a}function cadenaRandom(t,e){for(var o="",a=0;a<t;a++){var r=Math.floor(Math.random()*e.length);o+=e.charAt(r)}return o}function chatSubmit(t){t.preventDefault();const e=txtQuestion.value,o=t.target;if(this.reset(),!texto3.test(e))return alertSToast("center",6e3,"warning","Por favor, escribe una pregunta 🧐😬");var a=cadenaRandom(5,alfabetico);const r=`uuid${a}`,n=`<div class="output_block"><div class="btn_detail chat_msg user_submit" data-tokeid="${r}">${e}</div></div>`;contOutput.insertAdjacentHTML("beforeend",n);const s=document.querySelector(`.user_submit[data-tokeid="${r}"]`);setTimeout(function(){s.classList.add("visible"),setTimeout(scrollToBottom,500)},20),fetch(o.action,{method:"POST",body:JSON.stringify({question:e}),headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRFToken":o.querySelector("[name=csrfmiddlewaretoken]").value}}).then(t=>t.ok?t.json():t.json().then(t=>{throw new Error(t.message||"Error desconocido")})).then(t=>{if(t.success){console.table(t.answer);const e=t.answer.imagenes,o=t.answer.redirigir;console.log("img:"+typeof e),console.log("url:"+typeof o);let a="",n="";null!=e&&(a=`<br><br> <img src="${e}" class="img-fluid rounded" width="350">`),null!=o&&(n=`<br><br> <a class="btn btn_detail mb-2" style="min-width:300px;" target="_blank" rel="noopener noreferrer" href="${o}" >Ver Mas <i class="fa-solid fa-arrow-up-right-from-square ms-1"></i></a>`);const s=`<div class="chat_msg asistent_response" data-tokeid="${r}"><span>${t.answer.informacion}  ${n} </span><span>${a} </span></div>`;contOutput.insertAdjacentHTML("beforeend",s);const i=document.querySelector(`.asistent_response[data-tokeid="${r}"]`);setTimeout(function(){setTimeout(function(){i.classList.add("visible"),setTimeout(scrollToBottom,350)},970)},20)}else alertSToast("top",8e3,"error",`Error: ${t.message}`)}).catch(t=>{console.error("😥 Error:",t),alertSToast("top",8e3,"warning","Ocurrió un error. Intente nuevamente. 😥")})}function scrollToBottom(){contOutput.scrollTop=contOutput.scrollHeight}function jsonSubmit(t){t.preventDefault=t.preventDefault||function(){},t.preventDefault();const e=t.target,o=new FormData(e);if(o.has("contenidoWord")){const t=tinymce.activeEditor.getContent();o.set("contenidoWord",t);const e=tinymce.activeEditor.getContent({format:"text"});o.set("textTiny",e)}fetch(e.action,{method:"POST",body:o,headers:{"X-Requested-With":"XMLHttpRequest","X-CSRFToken":formToken}}).then(t=>t.ok?t.json():t.json().then(t=>{throw new Error(t.message||"Error desconocido")})).then(t=>{if(dataMessage=t.message,1==t.success){function e(e){window.location.href=t.redirect_url}if(dataIcon="success",t.icon&&(dataIcon=t.icon),dataPosition="center",t.position&&(dataPosition=t.position),"singin"==t.functions)return void e();if("reload"==t.functions)var o=function(){location.reload()};else if("redirect"==t.functions)o=function(){e()};const a=document.querySelectorAll('input[type="password"]');a.forEach(t=>t.value=""),alertSToast(dataPosition,timerOut,dataIcon,dataMessage,o)}else if(0==t.success){if(console.error(dataMessage),t.valSelector){function a(t){document.querySelector(`[data-selector-input="${t}"]`).classList.add("is-invalid"),document.querySelector(`[data-selector-input="${t}"]`).classList.remove("is-valid")}console.log(t.valSelector),a(t.valSelector)}alertSToast("top",timerOut+6e3,"warning",dataMessage)}}).catch(t=>{console.error("😥 Error:",t),errorMessage=t.message||"Ocurrió un error. Intente nuevamente. 😥",alertSToast("center",timerOut+8e3,"error",errorMessage)})}function alertSToast(t,e,o,a,r){const n=Swal.mixin({toast:!0,position:t,showConfirmButton:!1,showCloseButton:!0,timer:e,timerProgressBar:!0,customClass:{icon:"icon_alert",title:"title_alert",timerProgressBar:"progressbar_alert",closeButton:"close_button_alert"},didOpen:t=>{t.addEventListener("mouseenter",Swal.stopTimer),t.addEventListener("mouseleave",Swal.resumeTimer)},didDestroy:r});n.fire({icon:o,title:a})}var alfabetico="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",alfanumerico="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",caracteres="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-%$#@!*&^.",texto3=/[a-zA-Z0-9]{3}/,formToken=getCSRFToken(),timerOut=5e3,expressions={name:/^[a-zA-ZÀ-ÿ\s]+$/,username:/^(?![0-9_-])[a-zA-Z0-9_-]+$/,email:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/};$(document).ready(function(){try{$(".modal").on("shown.bs.modal",function(t){$("body").addClass("body_minus")}),$(".modal").on("hidden.bs.modal",function(t){$("body").removeClass("body_minus")});var t=$("#searchInput");function e(){var e=t.val().toLowerCase();$("#searchInput").text(e);$(".results_item").filter(function(){return $(this).toggle($(this).text().toLowerCase().indexOf(e)>-1),$(this).is(":visible")}).length}t.on("input",e),$(".controls_btn_microphone").click(()=>{$(".asistent_group").addClass("open open_controls bg-body-tertiary"),$(".btn_controls").addClass("btn_detail").removeClass("btn_secondary"),$("#btn_controls_icon").removeClass("fa-comment text_detail").addClass("fa-microphone")}),$(".toggle_controls").click(()=>{$(".asistent_group.open").toggleClass("close_controls open_keyboard open_controls");const t=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);t||setTimeout(function(){$(".controls_input #question").focus()},1e3)}),$(".controls_btn_close").click(()=>{$(".asistent_group").removeClass("open open_controls close_controls open_keyboard bg-body-tertiary"),$(".btn_controls").removeClass("btn_detail").addClass("btn_secondary"),$("#btn_controls_icon").addClass("fa-comment text_detail").removeClass("fa-microphone")});var o=1/0;let c=null;function a(){$(this).addClass("active");var t=cadenaRandom(8,caracteres),e=$(this).data("editinput");setTimeout(()=>{$(this).removeClass("active")},1e3),$("#"+e).val(t).focus()}function r(){const t=["#4285F4","#EA4335","#FBBC05","#4285F4","#34A853","#EA4335"],e=$(".style_google"),o=e.text();e.empty();for(let a=0;a<o.length;a++)e.append(`<span style="color:${t[a]}">${o[a]}</span>`)}$('[id^="bannerid_"]').each(function(){var t=$(this).attr("id"),e=parseInt(t.split("_")[1]);e<o&&(o=e,c=$(this))}),null!==c&&c.addClass("active"),$("#txtQuestion").keydown(t=>{13!==t.keyCode||t.shiftKey||(t.preventDefault(),$("#chatForm_submit").click())}),$("#chatForm").submit(chatSubmit),$("[data-submit-form]").submit(jsonSubmit),$("button[data-editinput]").click(a),$("[data-btn_closed]").on("click",function(){var t=$(this).data("btn_closed");$("#"+t).toggleClass("show")}),$("[data-reset_form]").on("click",function(){var t=$(this).data("reset_form"),e=$("#"+t)[0];e&&e.reset()}),r(),$(document).on("keydown",function(t){"Escape"!==t.key&&27!==t.keyCode||Swal.close()});const d=$("input[data-init-clear], textarea[data-init-clear]");d.each(function(){$(this).on("input",function(){let t=$(this).attr("id"),e=$(`[data-clear="${t}"]`);""==$(this).val()?e.hide():e.show()})});const u=$("[data-clear]");u.on("click",function(){const t=$(this).attr("data-clear");$(`#${t}`).val(""),$(this).slideUp("fast")}),$("#markAsReadButton").on("click",function(){$('[id^="notif_"]').each(function(){$(this).removeClass("list-group-item-warning list-group-item-info list-group-item-success list-group-item-danger list-group-item-primary")}),$('[id^="notif_"]').each(function(){$(this).addClass("list-group-item-secondary")});var t=[];$('[id^="notif_"]').each(function(){t.push($(this).attr("id"))}),localStorage.setItem("notificationIds",JSON.stringify(t))}),$(".notification-checkbox").on("change",function(){var t=$(this),e=t.data("id"),o=t.data("val-post"),a=[e];$.ajax({url:o,method:"POST",data:JSON.stringify({ids:a}),contentType:"application/json",headers:{"X-CSRFToken":formToken},success:function(e){message=e.message,"success"===e.status?(t.closest("li").removeClass("list-group-item-warning list-group-item-info list-group-item-success list-group-item-danger list-group-item-primary").addClass("list-group-item-secondary"),setTimeout(()=>{t.slideUp()},2e3)):console.error(message),alertSToast("top",4e3,e.icon,message)}})});var n=JSON.parse(localStorage.getItem("notificationIds"))||[];n.forEach(function(t){$("#"+t).removeClass("list-group-item-warning list-group-item-info list-group-item-success list-group-item-danger list-group-item-primary"),$("#"+t).addClass("list-group-item-secondary")}),$("[data-change-color]").on("click",function(){$("[data-change-color]").each(function(t,e){$(e).removeClass("active")});var t=$(this).addClass("active").data("change-color"),e=$(this).data("rgb");$("html").attr("data-color_prefer",t),localStorage.setItem("data-color_prefer",t),localStorage.setItem("data-color_rgb",e)});const m=localStorage.getItem("data-color_prefer");m?($(`[data-change-color="${m}"]`).addClass("active"),$("html").attr("data-color_prefer",m)):($('[data-change-color="blue"]').addClass("active"),$("html").attr("data-color_prefer","blue")),$("#switchTheme").on("click",function(){$("#switchTheme").is(":checked")?($("#switchText").text("Claro"),$("html").attr("data-mdb-theme","light"),localStorage.setItem("data-mdb-theme","light"),localStorage.setItem("mapbox-last_layer","light-v11")):($("#switchText").text("Oscuro"),$("html").attr("data-mdb-theme","dark"),localStorage.setItem("data-mdb-theme","dark"),localStorage.setItem("mapbox-last_layer","dark-v11"))});const f=localStorage.getItem("data-mdb-theme");f&&("light"==f?($("#switchText").text("Claro"),$("#switchTheme").prop("checked",!0),$("html").attr("data-mdb-theme","light"),localStorage.setItem("mapbox-last_layer","light-v11")):($("#switchText").text("Oscuro"),$("#switchTheme").prop("checked",!1),$("html").attr("data-mdb-theme","dark"),localStorage.setItem("mapbox-last_layer","dark-v11")));const p=$.trim($("#firmaPerfilTexto").text());function s(t){if(t.files&&t.files[0]){var e=new FileReader;e.onload=function(t){$("[data-img_dom]").attr("src",t.target.result)},e.readAsDataURL(t.files[0])}}$("#new_firma").on("input",function(){const t=$(this).val();""===t.trim()?$("#firmaPerfilTexto").text(p):$("#firmaPerfilTexto").text(t)}),$("[data-img_dom-change]").change(function(){s(this)}),$("[data-input_transparent]").on({focus:function(){$(this).toggleClass("input_transparent")},blur:function(){$(this).toggleClass("input_transparent")}});var i=!1;function l(){i?$("#updatePassBlock").slideUp("fast"):$("#profileSaved").slideUp("fast",function(){$("#updatePassBlock").slideUp("fast")})}$("#updatePassBtn").on("click",function(){let t=$(this);$("#updatePassText").toggle(),$("#updatePassBtn").hasClass("bg_blue-green")?$("#profileSaved").slideDown("fast",function(){$("#updatePassBlock").slideDown("fast",function(){$("html, body").scrollTop($(document).height())})}):l(),"Cambiar Contraseña"==t.text()?(t.toggleClass("bg_blue-green bg_blue-red"),t.text("No Cambiar Contraseña"),i||$("#passwordSend").val(""),$("#newPass").val(""),$("#confNewPass").val("")):(t.toggleClass("bg_blue-green bg_blue-red"),t.text("Cambiar Contraseña"))}),$("[data-input_change]").each(function(){const t=$(this),e=t.attr("name");var o=t.val();t.on("input",function(){t.val()==o?(t.attr("name",`${e}`),l(),i=!1):(t.attr("name",`${e}Changed`),$("#profileSaved").slideDown("fast"),i=!0,""==t.val()&&t.attr("name",`${e}`))}),t.on("blur",function(){""==t.val()&&(t.attr("name",`${e}`),l(),i=!1)}),t.on("click",function(){e})}),$("input#deletePicture").change(function(){$(this).is(":checked")?($('[for="deletePicture"]').addClass("btn_press"),$("#profileSaved").slideDown("fast"),i=!0):($('[for="deletePicture"]').removeClass("btn_press"),l(),i=!1)}),$("#formularioArticulo #blogNewUpdate").change(function(){blogIdGet=$("#formularioArticulo #blogNewUpdate").val(),dataGetBlog=$("#formularioArticulo #blogNewUpdate").data("get-blog"),"newBlog"!=blogIdGet?$.ajax({url:dataGetBlog,type:"GET",data:{id:blogIdGet},success:function(t){$("#formularioArticulo #imgArticle").attr("src","/static/img/default_image.webp"),t.encabezado&&$("#formularioArticulo #imgArticle").attr("src",t.encabezado),$("#formularioArticulo #titulo").addClass("active").val(t.titulo);const e=t.contenido;tinymce.get("mainTiny").setContent(e),$("#formularioArticulo .blogSubmit").html('Modificar <i class="fa-regular fa-paper-plane ms-1"></i>'),$("#formularioArticulo .btnModal").slideDown("fast"),$("#blogDelete #blogDeleteTitle").text(t.titulo),$("#blogDelete #blogIdDelete").val(blogIdGet)},error:function(t){console.error("Error al obtener datos: "+t),alertSToast("center",8e3,"error","UPS! 😯🤔🧐<br> hubo un error al obtener los datos, consulte la consola.")}}):($("#formularioArticulo #imgArticle").attr("src","/static/img/default_image.webp"),$("#formularioArticulo #titulo").removeClass("active").val(""),tinymce.get("mainTiny").setContent(""),$("#formularioArticulo .blogSubmit").html('Publicar <i class="fa-regular fa-paper-plane ms-1"></i>'),$("#formularioArticulo .btnModal").slideUp("fast"),$("#blogDelete #blogDeleteTitle").text(""),$("#blogDelete #blogIdDelete").val(""))})}catch(t){console.error("Error Inesperado: ",t),alertSToast("center",8e3,"error","😥 Ah ocurrido un error inesperado. codigo: #304")}}),document.querySelector("main").classList.contains("main_container")&&(window.location.href="/logout");var contOutput=document.querySelector("#output"),btnCloseChat=$("#closeChat");if(btnCloseChat&&contOutput&&btnCloseChat.on("click",function(){const t=`uuid${cadenaRandom(5,alfabetico)}`,e="Hola 👋 ¡Bienvenido! Soy tu asistente virtual ¿En qué puedo ayudarte hoy?",o=`<div class="btn_detail chat_msg asistent_response" data-tokeid="${t}"><span>${e}</span></div>`;contOutput.insertAdjacentHTML("beforeend",o);const a=document.querySelector(`.asistent_response[data-tokeid="${t}"]`);setTimeout(function(){a.classList.add("visible"),scrollToBottom()},20)}),contOutput){function scrollToBottom(){contOutput.scrollTop=contOutput.scrollHeight}var observer=new MutationObserver(()=>{scrollToBottom()});scrollToBottom(),observer.observe(contOutput,{childList:!0,subtree:!0})}const inputs=document.querySelectorAll("input[data-copy]");inputs.forEach(t=>{const e=()=>{if(!navigator.clipboard)return void alertSToast("center",8e3,"info","Tu navegador no admite copiar al portapapeles 😯😥🤔");const e=t.value;""!=e&&navigator.clipboard.writeText(e).then(()=>{alertSToast("top",5e3,"success","Texto Copiado! 🥳")}).catch(t=>{const e="Error al copiar al portapapeles";console.error(e,":",t),alertSToast("top",8e3,"error",`${e} 🤔😥`)})};t.addEventListener("click",e),t.addEventListener("focus",e)});var imagesZoom=document.querySelectorAll(".materialBoxed"),instances=M.Materialbox.init(imagesZoom);document.oncontextmenu=function(){return!1};